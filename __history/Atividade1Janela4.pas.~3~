unit Atividade1Janela4;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.ExtCtrls,Data.DBXMySQL, Data.FMTBcd, Datasnap.DBClient, Datasnap.Provider, Data.DB, Data.SqlExpr,
  UNadmingroup;

type
  TForm4 = class(TForm)
    Panel1: TPanel;
    Label1: TLabel;
    Label2: TLabel;
    Edit1: TEdit;
    Edit2: TEdit;
    Panel2: TPanel;
    Confirmar: TButton;
    Cancelar: TButton;
    procedure ConfirmarClick(Sender: TObject);
  private
    { Private declarations }
  public
    Alterar: Boolean;
    ClientDataSet : TClientDataSet;
  end;

var
  Form4: TForm4;

implementation

{$R *.dfm}

procedure TForm4.ConfirmarClick(Sender: TObject);
var
    res : boolean;
    flag : char;
    Cadmingroup : TAdmingroup;
    //CSpeciality : TSpeciality;
    begin
      Cadmingroup := TAdminGroup.Create;
      res := false;
      flag := 'E';
      if CheckBox1.State = cbChecked then
      begin
        flag:='B';
      end;
      if ((CheckBox1.State = cbChecked) or (CheckBox1.State = cbUnchecked))
      and (Edit1.GetTextLen > 0) and (Edit2.GetTextLen > 0) and (ComboBox1.GetTextLen > 0) then
        begin
        if alterar = true then
        begin
          CSpeciality.specialityid := Edit1.Text;
          CSpeciality.comando := CMDDetalhes;
          CSpeciality := Tcontroller.getinstance.ctrlspeciality(CSpeciality, ClientDataSet);
          CSpeciality.description := Edit2.Text;
          CSpeciality.flag_funcao_oper := flag;
          CSpeciality.codg_admin_group := ComboBox1.Text;
          CSpeciality.comando := CMDAlterar;
          Tcontroller.getinstance.ctrlspeciality(CSpeciality, ClientDataSet);
          //tdatamodule1.getinstance.alterarSpeciality(edit2.Text,flag,combobox1.Text,edit1.Text);
          res := true;
        end
        else
        begin
          Cadmingroup.specialityid := Edit1.Text;
          Cadmingroup.description := Edit2.Text;
          Cadmingroup.flag_funcao_oper := flag;
          Cadmingroup.codg_admin_group := ComboBox1.Text;
          Cadmingroup.comando := CMDIncluir;
          Tcontroller.getinstance.ctrladm(CSpeciality, ClientDataSet);
          res := true;
         end;
         if res = true then
         begin
         close;
         end;
        end
      else
        begin
         showmessage('Todos os campos devem ser preenchidos');
        end;
    end;

end.
